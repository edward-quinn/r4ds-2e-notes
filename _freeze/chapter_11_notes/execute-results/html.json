{
  "hash": "19212438691f4ff9d79ad6dccc3267ac",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"R for Data Science, 2nd Edition - Chapter 11 Notes\"\nfreeze: true\nformat:\n    html:\n        toc: true\n        toc-title: Contents\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n# 11 Communication\n\nHere we go from exploratory to expository graphs.\n\nThey recommend `The Truthful Art` by Albert Cairo as a guide for data visualization.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.6\n✔ forcats   1.0.1     ✔ stringr   1.6.0\n✔ ggplot2   4.0.1     ✔ tibble    3.3.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.2\n✔ purrr     1.2.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(scales)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'scales'\n\nThe following object is masked from 'package:purrr':\n\n    discard\n\nThe following object is masked from 'package:readr':\n\n    col_factor\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggrepel)\nlibrary(patchwork)\n```\n:::\n\n\n\n\n## 11.2 Labels\n\nLabels help to make a chart expository.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = class)) +\n  geom_smooth(se = FALSE) +\n  labs(\n    x = \"Engine displacement (L)\",\n    y = \"Highway fuel economy (mpg)\",\n    color = \"Car type\",\n    title = \"Fuel efficiency generally decreases with engine size\",\n    subtitle = \"Two seaters (sports cars) are an exception because of their light weight\",\n    caption = \"Data from fueleconomy.gov\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n## 11.3 Annotations\n\nSometimes it's helpful to label individual observations or groups of observations. You can use `geom_text()`, which functions like `geom_point()`, but it has an additional aesthetic: `label`, which is for textual labels to add to your plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlabel_info <- mpg |>\n  group_by(drv) |>\n  arrange(desc(displ)) |>\n  slice_head(n = 1) |>\n  mutate(\n    drive_type = case_when(\n      drv == \"f\" ~ \"front-wheel drive\",\n      drv == \"r\" ~ \"rear-wheel drive\",\n      drv == \"4\" ~ \"4-wheel drive\"\n    )\n  ) |>\n  select(displ, hwy, drv, drive_type)\n\nlabel_info\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n# Groups:   drv [3]\n  displ   hwy drv   drive_type       \n  <dbl> <int> <chr> <chr>            \n1   6.5    17 4     4-wheel drive    \n2   5.3    25 f     front-wheel drive\n3   7      24 r     rear-wheel drive \n```\n\n\n:::\n\n```{.r .cell-code}\n#> # A tibble: 3 × 4\n#> # Groups:   drv [3]\n#>   displ   hwy drv   drive_type       \n#>   <dbl> <int> <chr> <chr>            \n#> 1   6.5    17 4     4-wheel drive    \n#> 2   5.3    25 f     front-wheel drive\n#> 3   7      24 r     rear-wheel drive\n```\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy, color = drv)) +\n  geom_point(alpha = 0.3) +\n  geom_smooth(se = FALSE) +\n  geom_text(\n    data = label_info, \n    aes(x = displ, y = hwy, label = drive_type),\n    fontface = \"bold\", size = 5, hjust = \"right\", vjust = \"bottom\"\n  ) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#> `geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n\n\nTo prevent labels from overlapping with one another and/or with the data, use `geom_label_repel()` from the `ggrepel` package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy, color = drv)) +\n  geom_point(alpha = 0.3) +\n  geom_smooth(se = FALSE) +\n  geom_label_repel(\n    data = label_info, \n    aes(x = displ, y = hwy, label = drive_type),\n    fontface = \"bold\", size = 5, nudge_y = 2\n  ) +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#> `geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n\nAnother handy use case for `geom_text_repel()` is to highlight outliers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npotential_outliers <- mpg |>\n  filter(hwy > 40 | (hwy > 20 & displ > 5))\n  \nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point() +\n  geom_text_repel(data = potential_outliers, aes(label = model)) +\n  geom_point(data = potential_outliers, color = \"red\") +\n  geom_point(\n    data = potential_outliers,\n    color = \"red\", size = 3, shape = \"circle open\"\n  )\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nMore annotation ideas:\n\nUse `geom_hline()` and `geom_vline()` to add reference lines. We often make them thick (`linewidth = 2`) and white (`color = white`), and draw them underneath the primary data layer. That makes them easy to see, without drawing attention away from the data.\n\nUse `geom_rect()` to draw a rectangle around points of interest. The boundaries of the rectangle are defined by aesthetics `xmin`, `xmax`, `ymin`, `ymax.` Alternatively, look into the `ggforce` package, specifically `geom_mark_hull()`, which allows you to annotate subsets of points with hulls.\n\nUse `geom_segment()` with the arrow argument to draw attention to a point with an arrow. Use aesthetics `x` and `y` to define the starting location, and `xend` and `yend` to define the end location.\n\nUse `annotate()` to highlight just one or two points or ideas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrend_text <- \"Larger engine sizes tend to have lower fuel economy.\" |>\n  str_wrap(width = 30)\ntrend_text\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Larger engine sizes tend to\\nhave lower fuel economy.\"\n```\n\n\n:::\n\n```{.r .cell-code}\n#> [1] \"Larger engine sizes tend to\\nhave lower fuel economy.\"\n```\n:::\n\n\nNote the annotaiton is accomplised with a `label` geom and a `segment` geom, which are both called within the `annotate` function, in two separate calls to the function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point() +\n  annotate(\n    geom = \"label\", x = 3.5, y = 38,\n    label = trend_text,\n    hjust = \"left\", color = \"red\"\n  ) +\n  annotate(\n    geom = \"segment\",\n    x = 3, y = 35, xend = 5, yend = 25, color = \"red\",\n    arrow = arrow(type = \"closed\")\n  )\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n## 11.4 Scales\n\nControl how the aesthetic mappings manifest visually.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = class))\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nBehind the scenes, this is what happens:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = class)) +\n  scale_x_continuous() +\n  scale_y_continuous() +\n  scale_color_discrete() # chooses colors for each of the class of cars\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nYou may want to access these `scale` functions to change things like breaks on the axes, or the key labels on the legend.\n\nYou might want to replace the scale altogether.\n\n**Axis ticks and legend keys**.\n\nCollectively, axes and legends are called **guides**. Two arguments affect the appearance of the ticks on the axes and keys on the legend: `breaks` and `labels`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy, color = drv)) +\n  geom_point() +\n  scale_y_continuous(breaks = seq(15, 40, by = 5)) \n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n`labels` can be set to `NULL`, or a vector of length `breaks`, or in the case of a categorical variables, a named list with mappings to existing level names.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy, color = drv)) +\n  geom_point() +\n  scale_x_continuous(labels = NULL) +\n  scale_y_continuous(labels = NULL) +\n  scale_color_discrete(labels = c(\"4\" = \"4-wheel\", \"f\" = \"front\", \"r\" = \"rear\"))\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nThe `labels` argument can be combined with the `scales` package. Note that the `breaks` argument is on the original scale.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Left\nggplot(diamonds, aes(x = price, y = cut)) +\n  geom_boxplot(alpha = 0.05) +\n  scale_x_continuous(labels = label_dollar())\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Right\nggplot(diamonds, aes(x = price, y = cut)) +\n  geom_boxplot(alpha = 0.05) +\n  scale_x_continuous(\n    labels = label_dollar(scale = 1/1000, suffix = \"K\"), \n    breaks = seq(1000, 19000, by = 6000)\n  )\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n:::\n\n\n\n`label_percent()` is handy when visualizing proportions.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(diamonds, aes(x = cut, fill = clarity)) +\n  geom_bar(position = \"fill\") +\n  scale_y_continuous(name = \"Percentage\", labels = label_percent())\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n\nCustom `breaks` arguments can be useful when there isn't much data and you want to highlight specific data points.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npresidential |>\n  mutate(id = 33 + row_number()) |>\n  ggplot(aes(x = start, y = id)) +\n  geom_point() +\n  geom_segment(aes(xend = end, yend = id)) +\n  scale_x_date(name = NULL, breaks = presidential$start, date_labels = \"'%y\")\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n\n**Legend layout**.\n\nUse the `theme()` setting `legend_position()`. Also use `guides`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbase <- ggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = class))\n\nbase + theme(legend.position = \"right\") # the default\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\nbase + theme(legend.position = \"left\")\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n\n```{.r .cell-code}\nbase + \n  theme(legend.position = \"top\") +\n  guides(color = guide_legend(nrow = 3))\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-16-3.png){width=672}\n:::\n\n```{.r .cell-code}\nbase + \n  theme(legend.position = \"bottom\") +\n  guides(color = guide_legend(nrow = 3))\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-16-4.png){width=672}\n:::\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = class)) +\n  geom_smooth(se = FALSE) +\n  theme(legend.position = \"bottom\") +\n  guides(color = guide_legend(nrow = 2, override.aes = list(size = 4))) # aes override\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#> `geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n\n\n**Replacing a scale**. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Left\nggplot(diamonds, aes(x = carat, y = price)) +\n  geom_bin2d()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin2d()` using `bins = 30`. Pick better value `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#> `stat_bin2d()` using `bins = 30`. Pick better value `binwidth`.\n\n# Right\nggplot(diamonds, aes(x = log10(carat), y = log10(price))) +\n  geom_bin2d()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin2d()` using `bins = 30`. Pick better value `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-18-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#> `stat_bin2d()` using `bins = 30`. Pick better value `binwidth`.\n```\n:::\n\n\n\n`scale_color_brewer()` allows access to palettes that can be seen by people with color blindness.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = drv))\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = drv)) +\n  scale_color_brewer(palette = \"Set1\")\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-19-2.png){width=672}\n:::\n:::\n\n\n\nRedundant shape mapping also improves accessibility\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = drv, shape = drv)) +\n  scale_color_brewer(palette = \"Set1\")\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\nSpecify mapping between colors and variables using `scale_color_manual()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npresidential |>\n  mutate(id = 33 + row_number()) |>\n  ggplot(aes(x = start, y = id, color = party)) +\n  geom_point() +\n  geom_segment(aes(xend = end, yend = id)) +\n  scale_color_manual(values = c(Republican = \"#E81B23\", Democratic = \"#00AEF3\"))\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\nViridis color scales are available, and also accessible for continuous, discrete, and binned palettes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- tibble(\n  x = rnorm(10000),\n  y = rnorm(10000)\n)\n\nggplot(df, aes(x, y)) +\n  geom_hex() +\n  coord_fixed() +\n  labs(title = \"Default, continuous\", x = NULL, y = NULL)\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(df, aes(x, y)) +\n  geom_hex() +\n  coord_fixed() +\n  scale_fill_viridis_c() +\n  labs(title = \"Viridis, continuous\", x = NULL, y = NULL)\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-22-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(df, aes(x, y)) +\n  geom_hex() +\n  coord_fixed() +\n  scale_fill_viridis_b() +\n  labs(title = \"Viridis, binned\", x = NULL, y = NULL)\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-22-3.png){width=672}\n:::\n:::\n\n\nYou can zoom in on a portion of the plot using `coord_cartesian()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Left\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = drv)) +\n  geom_smooth() +\n  scale_x_continuous(limits = c(5, 6)) +\n  scale_y_continuous(limits = c(10, 25))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 202 rows containing non-finite outside the scale range\n(`stat_smooth()`).\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 202 rows containing missing values or values outside the scale range\n(`geom_point()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Right\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = drv)) +\n  geom_smooth() +\n  coord_cartesian(xlim = c(5, 6), ylim = c(10, 25))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-23-2.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuv <- mpg |> filter(class == \"suv\")\ncompact <- mpg |> filter(class == \"compact\")\n\n# Left\nggplot(suv, aes(x = displ, y = hwy, color = drv)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Right\nggplot(compact, aes(x = displ, y = hwy, color = drv)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-24-2.png){width=672}\n:::\n:::\n\n\n\nEnforcing common scale limits across plots to enhance comparison.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx_scale <- scale_x_continuous(limits = range(mpg$displ))\ny_scale <- scale_y_continuous(limits = range(mpg$hwy))\ncol_scale <- scale_color_discrete(limits = unique(mpg$drv))\n\n# Left\nggplot(suv, aes(x = displ, y = hwy, color = drv)) +\n  geom_point() +\n  x_scale +\n  y_scale +\n  col_scale\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Right\nggplot(compact, aes(x = displ, y = hwy, color = drv)) +\n  geom_point() +\n  x_scale +\n  y_scale +\n  col_scale\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-25-2.png){width=672}\n:::\n:::\n\n\n\n\n## 11.5 Themes\n\nCustomize non-data elements with a theme.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point(aes(color = class)) +\n  geom_smooth(se = FALSE) +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\nCreate your own themes, use those included in `ggplot2` or use extension packages like `ggthemes`.\n\n## 11.6 Layout\n\nThe `+` operator in the `patchwork` package places two plots next to each other.\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(mpg, aes(x = displ, y = hwy)) + \n  geom_point() + \n  labs(title = \"Plot 1\")\np2 <- ggplot(mpg, aes(x = drv, y = hwy)) + \n  geom_boxplot() + \n  labs(title = \"Plot 2\")\np1 + p2\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\nMore complex layouts with `|` and `/`. \n\n\n::: {.cell}\n\n```{.r .cell-code}\np3 <- ggplot(mpg, aes(x = cty, y = hwy)) + \n  geom_point() + \n  labs(title = \"Plot 3\")\n(p1 | p3) / p2\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np1 <- ggplot(mpg, aes(x = drv, y = cty, color = drv)) + \n  geom_boxplot(show.legend = FALSE) + \n  labs(title = \"Plot 1\")\n\np2 <- ggplot(mpg, aes(x = drv, y = hwy, color = drv)) + \n  geom_boxplot(show.legend = FALSE) + \n  labs(title = \"Plot 2\")\n\np3 <- ggplot(mpg, aes(x = cty, color = drv, fill = drv)) + \n  geom_density(alpha = 0.5) + \n  labs(title = \"Plot 3\")\n\np4 <- ggplot(mpg, aes(x = hwy, color = drv, fill = drv)) + \n  geom_density(alpha = 0.5) + \n  labs(title = \"Plot 4\")\n\np5 <- ggplot(mpg, aes(x = cty, y = hwy, color = drv)) + \n  geom_point(show.legend = FALSE) + \n  facet_wrap(~drv) +\n  labs(title = \"Plot 5\")\n\n(guide_area() / (p1 + p2) / (p3 + p4) / p5) +\n  plot_annotation(\n    title = \"City and highway mileage for cars with different drive trains\",\n    caption = \"Source: https://fueleconomy.gov.\"\n  ) +\n  plot_layout(\n    guides = \"collect\",\n    heights = c(1, 3, 2, 4)\n    ) &\n  theme(legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![](chapter_11_notes_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n\n\n",
    "supporting": [
      "chapter_11_notes_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}